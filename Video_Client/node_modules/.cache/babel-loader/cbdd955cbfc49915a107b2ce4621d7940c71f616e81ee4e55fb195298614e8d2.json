{"ast":null,"code":"import { DATA_BUCKET_ATTR } from '../constants.esm.js';\nfunction createIsomorphicStyleSheet(styleElement, bucketName, elementAttributes) {\n  // no CSSStyleSheet in SSR, just append rules here for server render\n  const __cssRulesForSSR = [];\n  elementAttributes[DATA_BUCKET_ATTR] = bucketName;\n  if (styleElement) {\n    for (const attrName in elementAttributes) {\n      styleElement.setAttribute(attrName, elementAttributes[attrName]);\n    }\n  }\n  function insertRule(rule) {\n    if (styleElement != null && styleElement.sheet) {\n      return styleElement.sheet.insertRule(rule, styleElement.sheet.cssRules.length);\n    }\n    return __cssRulesForSSR.push(rule);\n  }\n  return {\n    elementAttributes,\n    insertRule,\n    element: styleElement,\n    bucketName,\n    cssRules() {\n      if (styleElement != null && styleElement.sheet) {\n        return Array.from(styleElement.sheet.cssRules).map(cssRule => cssRule.cssText);\n      }\n      return __cssRulesForSSR;\n    }\n  };\n}\nfunction createIsomorphicStyleSheetFromElement(element) {\n  const elementAttributes = Array.from(element.attributes).reduce((acc, attr) => {\n    acc[attr.name] = attr.value;\n    return acc;\n  }, {});\n  const stylesheet = createIsomorphicStyleSheet(element, elementAttributes[DATA_BUCKET_ATTR], elementAttributes);\n  return stylesheet;\n}\nexport { createIsomorphicStyleSheet, createIsomorphicStyleSheetFromElement };","map":{"version":3,"names":["createIsomorphicStyleSheet","styleElement","bucketName","elementAttributes","__cssRulesForSSR","DATA_BUCKET_ATTR","attrName","setAttribute","insertRule","rule","sheet","cssRules","length","push","element","Array","from","map","cssRule","cssText","createIsomorphicStyleSheetFromElement","attributes","reduce","acc","attr","name","value","stylesheet"],"sources":["/Users/gideoncrawley/Projects/Lookeeloo/packages/core/src/renderer/createIsomorphicStyleSheet.ts"],"sourcesContent":["import { DATA_BUCKET_ATTR } from '../constants';\nimport type { IsomorphicStyleSheet, StyleBucketName } from '../types';\n\nexport function createIsomorphicStyleSheet(\n  styleElement: HTMLStyleElement | undefined,\n  bucketName: StyleBucketName,\n  elementAttributes: Record<string, string>,\n): IsomorphicStyleSheet {\n  // no CSSStyleSheet in SSR, just append rules here for server render\n  const __cssRulesForSSR: string[] = [];\n\n  elementAttributes[DATA_BUCKET_ATTR] = bucketName;\n  if (styleElement) {\n    for (const attrName in elementAttributes) {\n      styleElement.setAttribute(attrName, elementAttributes[attrName]);\n    }\n  }\n\n  function insertRule(rule: string) {\n    if (styleElement?.sheet) {\n      return styleElement.sheet.insertRule(rule, styleElement.sheet.cssRules.length);\n    }\n\n    return __cssRulesForSSR.push(rule);\n  }\n\n  return {\n    elementAttributes,\n    insertRule,\n    element: styleElement,\n    bucketName,\n    cssRules() {\n      if (styleElement?.sheet) {\n        return Array.from(styleElement.sheet.cssRules).map(cssRule => cssRule.cssText);\n      }\n\n      return __cssRulesForSSR;\n    },\n  };\n}\n\nexport function createIsomorphicStyleSheetFromElement(element: HTMLStyleElement) {\n  const elementAttributes = Array.from(element.attributes).reduce((acc, attr) => {\n    acc[attr.name] = attr.value;\n    return acc;\n  }, {} as Record<string, string>);\n  const stylesheet = createIsomorphicStyleSheet(\n    element,\n    elementAttributes[DATA_BUCKET_ATTR] as StyleBucketName,\n    elementAttributes,\n  );\n  return stylesheet;\n}\n"],"mappings":";AAGO,SAASA,0BAA0BA,CACxCC,YAA0C,EAC1CC,UAA2B,EAC3BC,iBAAyC,EACnB;EACtB;EACA,MAAMC,gBAA0B,GAAG,EAAE;EAErCD,iBAAiB,CAACE,gBAAgB,CAAC,GAAGH,UAAU;EAChD,IAAID,YAAY,EAAE;IAChB,KAAK,MAAMK,QAAQ,IAAIH,iBAAiB,EAAE;MACxCF,YAAY,CAACM,YAAY,CAACD,QAAQ,EAAEH,iBAAiB,CAACG,QAAQ,CAAC,CAAC;IAClE;EACF;EAEA,SAASE,UAAUA,CAACC,IAAY,EAAE;IAChC,IAAIR,YAAY,YAAZA,YAAY,CAAES,KAAK,EAAE;MACvB,OAAOT,YAAY,CAACS,KAAK,CAACF,UAAU,CAACC,IAAI,EAAER,YAAY,CAACS,KAAK,CAACC,QAAQ,CAACC,MAAM,CAAC;IAChF;IAEA,OAAOR,gBAAgB,CAACS,IAAI,CAACJ,IAAI,CAAC;EACpC;EAEA,OAAO;IACLN,iBAAiB;IACjBK,UAAU;IACVM,OAAO,EAAEb,YAAY;IACrBC,UAAU;IACVS,QAAQA,CAAA,EAAG;MACT,IAAIV,YAAY,YAAZA,YAAY,CAAES,KAAK,EAAE;QACvB,OAAOK,KAAK,CAACC,IAAI,CAACf,YAAY,CAACS,KAAK,CAACC,QAAQ,CAAC,CAACM,GAAG,CAACC,OAAO,IAAIA,OAAO,CAACC,OAAO,CAAC;MAChF;MAEA,OAAOf,gBAAgB;IACzB;GACD;AACH;AAEO,SAASgB,qCAAqCA,CAACN,OAAyB,EAAE;EAC/E,MAAMX,iBAAiB,GAAGY,KAAK,CAACC,IAAI,CAACF,OAAO,CAACO,UAAU,CAAC,CAACC,MAAM,CAAC,CAACC,GAAG,EAAEC,IAAI,KAAK;IAC7ED,GAAG,CAACC,IAAI,CAACC,IAAI,CAAC,GAAGD,IAAI,CAACE,KAAK;IAC3B,OAAOH,GAAG;GACX,EAAE,EAA4B,CAAC;EAChC,MAAMI,UAAU,GAAG3B,0BAA0B,CAC3Cc,OAAO,EACPX,iBAAiB,CAACE,gBAAgB,CAAC,EACnCF,iBACF,CAAC;EACD,OAAOwB,UAAU;AACnB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}